# MVP персонального ассистента — подробное описание (v1)

## 0) Коротко о сути

Персональный ассистент на базе ИИ ведёт с человеком коучинговый диалог (по духу ICF), помогает прояснять цели и ценности, строит **персональный граф человека** (ценности → намерения/интенты → контекст → действия), запоминает данные, динамически обновляет приоритеты и предлагает **конкретные решения** через аффилированных партнёров (или взвешенные варианты рынка, если аффилиации нет). При согласовании — открывает партнёрский сайт/мини‑приложение и сопровождает пользователя до завершения действия (бронь, оплата, заявка).

MVP-фокус: **диалог, память, граф ценностей/интентов, рекомендации и переход к партнёрам**. Дополнительно: ввод голосом, Telegram-мини‑приложение, базовые сценарии (отпуск/покупка услуг/обучение/финансы‑лайт).

---

## 1) Ценность и задачи

### Для пользователя

* Понять, чего *действительно* хочет (осознанность + ясность).
* Получать предложения, созвучные личным ценностям и текущему контексту.
* Экономить время и избегать перегруза выбором.
* Иметь «личную память» ассистента: данные, предпочтения, история решений.

### Для бизнеса

* Рост конверсии за счёт персонализации (граф ценностей → релевантные офферы).
* Монетизация через аффилиации/рефералку/лидогенерацию.
* Повторные обращения благодаря «эффекту персонального профиля».
* Данные (с согласия) для улучшения рекомендаций и кросс‑селла.

---

## 2) Персонажи (User Personas)

1. **Андрей, 33** — предприниматель, мало времени, высокая неопределённость. Хочет «ассистента‑навигатора», чтобы быстро принимать решения (от отпусков до выборов сервисов).
2. **Марина, 29** — специалист в найме, использует ассистента для личного развития и подбора обучения/путешествий.
3. **Семья с детьми** — ищут отдых и сервисы, соответствующие ценностям (безопасность, природа, тишина/активности, питание).

---

## 3) Ключевая концепция: Граф ценностей и интентов

* **Ценности** — устойчивые ориентиры («свобода», «семья», «здоровье», «рост» и т.п.).
* **Интенты (намерения)** — динамичные «вектора» желаний/задач; у одного человека может быть **до 200** уникальных интентов.
* **Контекст** — параметры времени, бюджета, географии, ограничений (дети, паспорт, визы, здоровье и т.п.).
* **Связи** — ребра графа: ценность ↔ интент ↔ опции ↔ действия.

### Поведение графа

* Ассистент постоянно «сверяет» новые ответы с графом: *«Ты раньше говорил, что для тебя важнее A, чем B. Сейчас по‑прежнему так?»*
* Поддерживается **обновление, ужимание (слияние похожих), переоценка приоритетов**, архивирование устаревших интентов.
* Каждый интент имеет: важность (weight), уверенность (confidence), свежесть (last\_update), источники («из слов пользователя», «из поведения»).

---

## 4) MVP‑сценарии (use cases)

1. **Отпуск по ценностям**
   Пользователь: «Хочу перезагрузиться в тишине у моря, бюджет 1500€, сентябрь, тёплый климат».
   Ассистент уточняет ключевые ценности (тишина/природа/дети/еда), фиксирует интенты, предлагает 3–5 маршрутов (ссылки на аффилированных партнёров/агрегаторы), показывает плюсы/минусы, помогает забронировать.

2. **Саморазвитие / обучение**
   «Хочу подтянуть продуктовый менеджмент, не тратить больше 5 часов в неделю».
   Ассистент предлагает курсы/менторов под стиль обучения и ценности («практика», «сообщество»), даёт календарный план.

3. **Финансы (лайт в MVP)**
   «Хочу копить на дом и иметь 500\$ в месяц свободных денег».
   Ассистент помогает настроить бюджет (категории, напоминания), даёт мягкие рекомендации (без инвестиционного советничества), сохраняет цели/ограничения.

4. **Lifestyle**
   «Ищу спокойные кафе с вегетарианским меню и детской зоной в выходные».
   Ассистент учитывает ценности (здоровье/семья), предлагает варианты, сохраняет понравившиеся, учится на выборе.

---

## 5) Диалог и стиль (ICF‑инспирированный)

* Один вопрос за раз, простые формулировки, активное слушание.
* Отражение и уточнение: «Верно ли, что для тебя сейчас главное — отдых без суеты?»
* Работа с метафорами: «Ты описал отдых как ‘дыхание’. Что это значит для тебя на практике?»
* Этические рамки: без давления и навязывания; предложения — как опции.
* «Память о противоречиях»: бережное корректирование курса, когда мнение меняется.

---

## 6) Функциональные требования (MVP)

### 6.1 Диалоговая система

* Текстовый интерфейс (Telegram мини‑апп + Web‑виджет).
* Поддержка голосового ввода (ASR), опционально TTS‑ответы.
* Управление сессией, идентификация пользователя, согласие на обработку данных.

### 6.2 Память и профиль

* Профиль: персональные данные (по согласию), цели, ценности, предпочтения.
* Хранилище интентов (до 200), механизм обновления/слияния.
* История диалогов, объяснимость решений («почему предложил это»).

### 6.3 Рекомендательная логика

* Матчинг: ценности/интенты ⇄ каталог партнёров/офферов.
* Взвешивание: релевантность, бюджет/время/гео/ограничения.
* Вывод 3–5 вариантов с кратким сравнением (плюсы/минусы).
* Если нет аффилиации — предлагаются нейтральные рыночные опции.

### 6.4 Переход к действию

* Глубокая ссылка / открытие партнёрского сайта/бота/мини‑приложения.
* Передача параметров (если поддерживается партнёром): даты, город, бюджет.
* Отслеживание статуса (по возможности): «перешёл», «заявка», «бронь».

### 6.5 Настройки и контроль

* Прозрачность: просмотр и редактирование личных данных/интентов.
* Быстрая смена приоритетов: «Сейчас важнее тишина, чем бюджет».
* Удаление данных по запросу, выгрузка (портируемость).

---

## 7) Нефункциональные требования

* **Конфиденциальность и согласие**: GDPR‑совместимость (явное согласие, право на удаление/доступ, минимизация).
* **Безопасность**: шифрование в покое и при передаче, управление ключами, аудит логов.
* **Надёжность**: graceful‑fallback при ошибках сторонних API, сохранение черновиков рекомендаций.
* **Производительность**: среднее время ответа ≤ 2–3 сек (без тяжёлых внешних вызовов).
* **Объяснимость**: краткое «почему это предложено».

---

## 8) Источники и интеграции (MVP)

* **Фронтенд**: Telegram Mini App + Web‑виджет (чат + карточки вариантов + кнопки перехода).
* **Голос**: ASR (например, Whisper/аналог), TTS (опционально).
* **Каталоги/офферы**: внутренний справочник партнёров (аффилиации) + коннекторы к агрегаторам (поэтапно).
* **Трекинг аффилиаций**: UTM/реф‑параметры, пиксели/вебхуки (если поддерживаются).
* **Оркестрация**: n8n для сценариев (обогащение данных, вебхуки партнёров, нотификации, CRM‑запись).
* **Хранилище**: Postgres (профили/интенты/сессии) + векторное хранилище (pgvector/Pinecone) для контекста.
* **Модель**: LLM‑оркестрация (диалог, извлечение ценностей/интентов, генерация рекомендаций), RAG для справочников.

---

## 9) Данные и модель графа

### 9.1 Мини‑схема (логическая)

* **user**(id, name, locale, consent\_flags, created\_at)
* **value**(id, label, description)
* **intent**(id, user\_id, label, value\_ids\[], weight, confidence, status, last\_update, notes)
* **context**(id, user\_id, timeframe, budget, geo, constraints\_json)
* **offer**(id, partner\_id, category, params\_json, geo, price\_range, tags\[])
* **match**(intent\_id, offer\_id, score, reason)
* **session**(id, user\_id, channel, started\_at, state)

### 9.2 Жизненный цикл интента

1. Инициация из слов пользователя/событий.
2. Обогащение (уточняющие вопросы).
3. Расчёт weight/confidence, связывание с ценностями.
4. Матчинг → варианты.
5. Принятие решения → фиксация действия.
6. Обновление/слияние/архивирование при изменении.

### 9.3 Правила обновления

* Изменение приоритетов явным утверждением пользователя > любая эвристика.
* Слияние, если косинусная близость описаний > порога (например 0.85) и ценности совпадают.
* «Старение» интентов: weight снижается со временем без подтверждений.

---

## 10) Диалоговые примеры (MVP)

**Сценарий «Отпуск»**

* Пользователь: «Хочу в сентябре к морю, спокойно и без толп, бюджет до 1500€».
* Ассистент: «Верно ли, что сейчас важнее тишина и природа, чем ночная жизнь? Могу предложить 3 направления. Подойдёт?»
* Пользователь: «Да, тишина важнее».
* Ассистент: «Супер. Тогда вижу 3 варианта: A, B, C. У A — +тишина, +тёплая вода, −пересадка; у B — +прямой рейс, −чуть дороже; у C — +дикая природа, −меньше кафе. Что ближе?»
* …
* Ассистент: «Открываю партнёрскую ссылку на B и передаю параметры. Напомнить завтра проверить цену?»

**Сценарий «Смена приоритетов»**

* Ассистент: «Ты раньше говорил, что для тебя важнее бюджет, чем расстояние. Сейчас вижу акцент на комфорт. Обновить приоритеты?»

---

## 11) Ограничения и этика

* Не выдаём медицинских/юридических/инвест‑советов (в MVP — общие рекомендации/обучающие материалы).
* Чёткая маркировка аффилированных предложений.
* Уважение к персональным данным; понятные настройки приватности.

---

## 12) KPI и метрики

* **GCR (Goal Completion Rate)**: доля диалогов, дошедших до действия (переход/заявка/бронь).
* **CTR по карточкам рекомендаций** и **конверсия аффилиаций**.
* **NPS/CSAT** по итогам сценариев.
* **Retention 7/30d**: доля вернувшихся пользователей.
* **Точность матчинга** (экспертная разметка первых кейсов).

---

## 13) Релизный план MVP (4–6 недель)

**Неделя 1** — каркас: чат (TG + Web), хранилище профиля/интентов, первые ценности.
**Неделя 2** — извлечение ценностей/интентов из диалога, редактор интентов, простые рекомендации.
**Неделя 3** — подключение 1–2 аффилированных партнёров, UTM/реф‑метки, карточки вариантов.
**Неделя 4** — голосовой ввод, объяснимость «почему предложено», базовая аналитика/KPI.
**Неделя 5–6** — полировка UX, A/B тексты вопросов, безопасность/политика приватности, демо‑скрипты.

---

## 14) Стек (рекомендуемый на MVP)

* **Фронт**: Telegram Mini App + Web (Next.js) / мобильный веб.
* **Бэкенд**: Node.js/Go + n8n для интеграций/оркестрации.
* **БД**: Postgres (+pgvector) / Pinecone (по необходимости).
* **LLM‑оркестрация**: сервер‑прокси, RAG для справочников/офферов.
* **ASR/TTS**: модульно, через адаптер.
* **Auth**: Telegram/OTP, сессии/ключи, роли.
* **Логи/метрики**: Prometheus/Grafana + событийная аналитика (PostHog/аналоги).

---

## 15) Риски и меры

* **Галлюцинации** → RAG + шаблоны ответов, чёткие источники.
* **Конфиденциальность** → минимизация данных, локализация в ЕС (GDPR), опция «без памяти».
* **Слабые партнёрские API** → кеширование/фоллбеки, альтернативные ссылки.
* **Промахи рекомендаций** → петля обратной связи, явное «Не актуально».

---

## 16) Монетизация (MVP → рост)

* **Аффилиации**: travel/обучение/сервисы.
* **Лидогенерация**: заявки в партнёрские компании.
* **Подписка Pro**: расширенная память/голос/приоритетная поддержка.
* **B2B‑лицензии**: white‑label ассистент для партнёров (после MVP).

---

## 17) Материалы для демо/продаж

* 2–3 сценария с отыгранными диалогами (отпуск, обучение, финансы‑лайт).
* Скриншоты карточек «вариантов» и окна интентов.
* Слайд «Граф ценностей → рекомендации → действие».

---

## 18) Чек‑лист готовности к MVP

* [ ] Диалог и извлечение ценностей/интентов (стабильно ≥80% корректности на пилотной выборке).
* [ ] Хранилище профиля и редактор интентов.
* [ ] Минимум 1 аффилированный партнёрный сценарий end‑to‑end.
* [ ] Переход по ссылке с параметрами, трекинг клика.
* [ ] Политика приватности и согласие.
* [ ] Сводка KPI/дашборд.

—
**Итог:** MVP покажет ценность «личного графа» и диалоговой осознанности, даст измеримые конверсии по аффилиациям и соберёт обратную связь для масштабирования (голос, финансы‑расширение, новые партнёры).
